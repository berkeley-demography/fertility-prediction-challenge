---
title: "Decision tree model"
format: html
editor: source
---

```{r}
library(here)
library(tidyverse)
library(tidymodels)
library(bundle)
```

```{r}
raw_data_dir <- here("data")
prepped_data_dir <- here("data-prepped")
```

## Open up the data

```{r}
rec <- unbundle(readRDS(file=here(prepped_data_dir, 'recipe.rds')))
                
train_data <- readRDS(file=here(prepped_data_dir, 'train_split.rds'))

df_train <- train_data$df_train
folds <- train_data$folds
```


DECISION TREE

```{r}
dt_model <-
  decision_tree() %>%
  set_engine('rpart') %>%
  set_mode('classification')

dt_workflow <-
  workflow() %>%
  add_model(dt_model) %>%
  add_recipe(rec)

dt_fit <-
  dt_workflow %>%
  fit(data=df_train)
```


```{r}
saveRDS(bundle(dt_fit),
        file=here(prepped_data_dir, 'fit_decision_tree.rds'))
```

